!function(){"use strict";class e{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this.id=e._id,this._cardSelector=t,this._data=e,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r,this._isLiked=e.isLiked}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeBtn=this._cardElement.querySelector(".card__button"),this._trashBtn=this._cardElement.querySelector(".card__trash"),this._likeBtn.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._trashBtn.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}deleteCard(){this._cardElement.remove()}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._likeBtn.classList.add("card__button-active"):this._likeBtn.classList.remove("card__button-active")}getView(){return this._element=this._getTemplate(),this._cardImageElement=this._element.querySelector(".card__image"),this._element.querySelector(".card__description").textContent=this._name,this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._setEventListeners(),this._renderLikes(),this._element}}class t{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorList=e.errorList,this._formGetReset=t.querySelector("#profile-edit-form")}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return this._inputElementsArray=Array.from(this._inputEls),this._inputElementsArray.some((e=>!e.validity.valid))}toggleButtonstate(){this._hasInvalidInput()?this.disableSubmitButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonstate()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this.toggleButtonstate()}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}}class s{constructor(e){this._popupSelector=e,this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_clickOverlay(e){e.target===this._popupElement&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{this._clickOverlay(e)})),this._closeBtn=this._popupElement.querySelector(".modal__close"),this._closeBtn.addEventListener("click",(()=>{this.close()}))}}class i extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputEls=this._popupForm.querySelectorAll(".modal__input"),this._submitBtn=this._popupElement.querySelector(".modal__save"),this._buttonText=this._submitBtn.textContent}_getInputValues(){return this._inputObj={},this._inputEls.forEach((e=>{this._inputObj[e.id]=e.value})),this._inputObj}reset(){this._popupForm.reset()}setInputValues(e){this._inputEls.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}showUploadingState(){this._submitBtn.innerText="Saving"}showUploaded(){this._submitBtn.innerText=this._buttonText}}class r{constructor(e,t){let{items:s,renderer:i}=e;this._renderedItems=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}addInitialItem(e){this._container.append(e)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}}const n=document.querySelectorAll(".modal__form"),o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",errorList:".modal__error"},a="modal-title-input",l=(document.getElementById(a),"modal-description-input"),d=(document.getElementById(l),"add-card-form"),h="change-profile-pic-form",c="profile-edit-form",u=(document.getElementById(c),"#card-template"),_=document.querySelector("#profile-edit-button"),m=document.querySelector(".profile__add-button"),p={},E=(document.querySelector("#delete-card-modal"),document.querySelectorAll(".card__trash"),document.querySelector("#profile-avatar-edit-button"));let b;document.querySelector("#change-profile-pic-modal"),document.querySelector("#delete-card-modal"),document.querySelector("#delete-card-submit-btn"),document.querySelector(".profile__photo"),document.querySelectorAll(".modal__save");const v=new class extends s{constructor(e){super(e),this._submitBtn=this._popupElement.querySelector(".modal__save"),this._btnText=this._submitBtn.textContent}setSubmitAction(e){this._handleFormSubmit=e}showLoading(){this._submitBtn.innerText="Loading"}showDeleted(){this._submitBtn.innerText=this._btnText}setEventListeners(){super.setEventListeners(),this._submitBtn.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#delete-card-modal"),f=new class extends s{constructor(e){super(e),this._picTitle=this._popupElement.querySelector("#open-pic-title"),this._image=this._popupElement.querySelector("#open-pic-image")}open(e){let{name:t,link:s}=e;this._picTitle.textContent=t,this._image.src=s,this._image.alt=t,super.open()}}("#open-pic-modal"),S=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarEl=document.querySelector(i)}getUserInfo(){return{title:this._nameEl.innerText,description:this._jobEl.innerText}}setUserInfo(e,t){this._nameEl.innerText=e,this._jobEl.innerText=t}setAvatar(e){this._avatarEl.src=e}}({nameSelector:"#js-profile-name",jobSelector:"#js-profile-description",avatarSelector:"#js-avatar"}),g=new i("#profile-add-card-modal",(function(e){const t=e["modal-image-title-input"],s=e["modal-link-input"];g.showUploadingState(),k.addNewCard({cardElementName:t,cardElementLink:s}).then((e=>{g.showUploaded();const t=I(e);b.addItem(t),p[d].disableSubmitButton(),g.close(),g.reset()})).catch((e=>{console.error(e)})).finally((()=>{g.showToUpload()}))})),L=new i("#profile-edit-modal",(function(e){const t=e[a],s=e[l];L.showUploadingState(),k.updateUserInfo({editFormNameInput:t,editFormAboutInput:s}).then((e=>{S.setUserInfo(e.name,e.about),L.close(),p[c].disableSubmitButton(),L.reset()})).catch((e=>{console.error(e)})).finally((()=>{L.showUploaded()}))})),y=new i("#change-profile-pic-modal",(function(e){y.showUploadingState();const t=e["modal-avatar-input"];k.updateProfileImage(t).then((e=>{console.log(e),S.setAvatar(e.avatar),y.close(),p[h].disableSubmitButton(),y.reset()})).catch((e=>{console.error(e)})).finally((()=>{y.showUploaded()}))})),k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this._headers=s}getResult(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this._headers}).then(this.getResult)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this._headers}).then(this.getResult)}updateUserInfo(e){let{editFormNameInput:t,editFormAboutInput:s}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this.getResult)}addNewCard(e){let{cardElementName:t,cardElementLink:s}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this.getResult)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this.getResult)}likeCard(e){return fetch(`${this.baseUrl}/cards/${e.id}/likes`,{method:"PUT",headers:this._headers}).then(this.getResult)}unlikeCard(e){return fetch(`${this.baseUrl}/cards/${e.id}/likes`,{method:"DELETE",headers:this._headers}).then(this.getResult)}updateProfileImage(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this.getResult)}getCardAndUserInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"62fbc1de-42d6-41b7-8bb5-5b0736932e96","Content-Type":"application/json"}});function I(t){return new e(t,u,C,q,B).getView()}function C(e){let{name:t,link:s}=e;f.open({name:t,link:s})}function B(e){(e.isLiked()?k.unlikeCard(e):k.likeCard(e)).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.error(e)}))}function q(e){v.open(),v.setSubmitAction((()=>{v.showLoading(),k.deleteCard(e.id).then((t=>{v.close(),e.deleteCard()})).catch((e=>{console.error(e)})).finally((()=>{v.showDeleted()}))}))}k.getCardAndUserInfo().then((e=>{let[t,s]=e;b=new r({items:t,renderer:e=>{const t=I(e);b.addInitialItem(t)}},".cards__list"),b.renderItems(t);const i=s.name,n=s.about,o=s.avatar;S.setUserInfo(i,n),S.setAvatar(o)})).catch((e=>{console.error(e)})),m.addEventListener("click",(()=>{p[d].resetValidation(),p[d].disableSubmitButton(),g.reset(),g.open()})),_.addEventListener("click",(()=>{p[c].resetValidation(),p[c].disableSubmitButton(),L.reset(),L.open(),function(){const e=S.getUserInfo();L.setInputValues(e)}()})),E.addEventListener("click",(()=>{y.reset(),p[h].resetValidation(),p[h].disableSubmitButton(),y.open()})),(e=>{e.forEach((e=>{const s=new t(o,e);return s.enableValidation(),p[e.getAttribute("id")]=s,p}))})(n),g.setEventListeners(),L.setEventListeners(),f.setEventListeners(),y.setEventListeners(),v.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBVW1MLEdBR2xELE9BRkFDLEVBQWMvSSxtQkFDZDJELEVBQWVtRixFQUFLRSxhQUFhLE9BQVNELEVBQ25DcEYsQ0FBYyxHQUNyQixFQXlCSjNELENBQWlCZ0QsR0FDakJtQyxFQUFhcEUsb0JBQ2JzRixFQUFVdEYsb0JBQ1ZvRCxFQUFVcEQsb0JBQ1Y4RixFQUFnQjlGLG9CQUNoQitDLEVBQWdCL0MsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLmlkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gIH1cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiAodGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b25cIik7XG4gICAgdGhpcy5fdHJhc2hCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpO1xuICAgIHRoaXMuX2xpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgICB0aGlzLl90cmFzaEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9kYXRhKTtcbiAgICB9KTtcbiAgfVxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG4gIC8vIHNldExpa2VBY3Rpb24oKSB7XG4gIC8vICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnV0dG9uLWFjdGl2ZVwiKTtcbiAgLy8gICB0aGlzLmlzTGlrZWQgPSAhdGhpcy5pc0xpa2VkO1xuICAvLyB9XG5cbiAgc2V0SXNMaWtlZChpc0xpa2VkKSB7XG4gICAgLy8gc2V0IGluc3RhbmNlIHZhcmlhYmxlXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIC8vIGFkZCBhY3RpdmUgY2xhc3MgdG8gdGhlIGxpa2UgYnV0dG9uXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19idXR0b24tYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZW1vdmUgYWN0aXZlIGNsYXNzIGZyb20gdGhlIGxpa2UgYnV0dG9uXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idXR0b24tYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckxpc3QgPSBzZXR0aW5ncy5lcnJvckxpc3Q7XG4gICAgdGhpcy5fZm9ybUdldFJlc2V0ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtZm9ybVwiKTtcbiAgfVxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuX2lucHV0RWxzKTtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbGVtZW50c0FycmF5LnNvbWUoKGlucHV0RWwpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuICB0b2dnbGVCdXR0b25zdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9KTtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvbnN0YXRlKCk7XG4gIH1cbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgX2NsaWNrT3ZlcmxheShlKSB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5fY2xpY2tPdmVybGF5KGUpO1xuICAgIH0pO1xuICAgIHRoaXMuX2Nsb3NlQnRuID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2Nsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0RWxzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0T2JqID0ge307XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faW5wdXRPYmpbaW5wdXRFbC5pZF0gPSBpbnB1dEVsLnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9pbnB1dE9iajtcbiAgfVxuICByZXNldCgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuICBzaG93VXBsb2FkaW5nU3RhdGUoKSB7XG4gICAgdGhpcy5fc3VibWl0QnRuLmlubmVyVGV4dCA9IFwiU2F2aW5nXCI7XG4gIH1cbiAgc2hvd1VwbG9hZGVkKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ0bi5pbm5lclRleHQgPSB0aGlzLl9idXR0b25UZXh0O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2xlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2xlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuICBhZGRJbml0aWFsSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG59XG4iLCIvKipUaGUgaW5kZXguanMgZmlsZSBtdXN0IGNvbnRhaW4gb25seSB0aGUgY29kZSBmb3Igc2VsZWN0aW5nIGVsZW1lbnRzLCBjcmVhdGluZyBjbGFzcyBpbnN0YW5jZXMsIGFuZCBhZGRpbmcgc3BlY2lmaWMgZXZlbnQgbGlzdGVuZXJzLiBPdGhlciBjb2RlLCBzdWNoIGFzIHRoZSBhcnJheSBvZiBpbml0aWFsIGNhcmRzIGFuZCBhbnkgY29uZmlndXJhdGlvbiBvYmplY3RzIHlvdSBhcmUgdXNpbmcsIHNob3VsZCBiZSBtb3ZlZCB0byBhIHNlcGFyYXRlIHV0aWxzL2NvbnN0YW50cy5qcyBmaWxlIGFuZCBpbXBvcnRlZCBpbnRvIGluZGV4LmpzICovXG5cbmV4cG9ydCBjb25zdCBjYXJkV3JhcHBlclNlbGVjdG9yID0gXCIuY2FyZHNfX2xpc3RcIjtcbmV4cG9ydCBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG4gIGVycm9yTGlzdDogXCIubW9kYWxfX2Vycm9yXCIsXG59O1xuZXhwb3J0IGNvbnN0IG5hbWVTZWxlY3RvciA9IFwiI2pzLXByb2ZpbGUtbmFtZVwiO1xuZXhwb3J0IGNvbnN0IGpvYlNlbGVjdG9yID0gXCIjanMtcHJvZmlsZS1kZXNjcmlwdGlvblwiO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cFNlbGVjdG9yID0gXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiO1xuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cFNlbGVjdG9yID0gXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCI7XG5leHBvcnQgY29uc3QgZWRpdElucHV0VGl0bGVJZCA9IFwibW9kYWwtdGl0bGUtaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBlZGl0SW5wdXRUaXRsZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWRpdElucHV0VGl0bGVJZCk7XG5leHBvcnQgY29uc3QgZWRpdElucHV0RGVzY3JpcHRpb25JZCA9IFwibW9kYWwtZGVzY3JpcHRpb24taW5wdXRcIjtcbmV4cG9ydCBjb25zdCBlZGl0SW5wdXREZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gIGVkaXRJbnB1dERlc2NyaXB0aW9uSWRcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZElucHV0VGl0bGVJZCA9IFwibW9kYWwtaW1hZ2UtdGl0bGUtaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBhZGRDYXJkSW5wdXRMaW5rSWQgPSBcIm1vZGFsLWxpbmstaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybUlkID0gXCJhZGQtY2FyZC1mb3JtXCI7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybUlkID0gXCJjaGFuZ2UtcHJvZmlsZS1waWMtZm9ybVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybUlkID0gXCJwcm9maWxlLWVkaXQtZm9ybVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb2ZpbGVFZGl0Rm9ybUlkKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcFNlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcGljUG9wdXBTZWxlY3RvciA9IFwiI29wZW4tcGljLW1vZGFsXCI7XG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHRyYXNoQnRuQXJyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXJkX190cmFzaFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1hdmF0YXItZWRpdC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNjaGFuZ2UtcHJvZmlsZS1waWMtbW9kYWxcIlxuKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0U2VsZWN0b3IgPSBcIiNjaGFuZ2UtcHJvZmlsZS1waWMtbW9kYWxcIjtcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkU2VsZWN0b3IgPSBcIiNkZWxldGUtY2FyZC1tb2RhbFwiO1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZFN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2RlbGV0ZS1jYXJkLXN1Ym1pdC1idG5cIlxuKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJMaW5rSW5wdXRJZCA9IFwibW9kYWwtYXZhdGFyLWlucHV0XCI7XG5leHBvcnQgY29uc3QgYXZhdGFySW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19waG90b1wiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJTZWxlY3RvciA9IFwiI2pzLWF2YXRhclwiO1xuZXhwb3J0IGNvbnN0IHNhdmVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fc2F2ZVwiKTtcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQge1xuICBhdmF0YXJFZGl0QnRuLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIHNhdmVCdG5zLFxuICBhdmF0YXJGb3JtSWQsXG4gIGF2YXRhclNlbGVjdG9yLFxuICBhdmF0YXJJbWcsXG4gIGF2YXRhckxpbmtJbnB1dElkLFxuICBwcm9maWxlRWRpdEZvcm1JZCxcbiAgZGVsZXRlQ2FyZEVsLFxuICBkZWxldGVDYXJkU3VibWl0QnRuLFxuICBkZWxldGVDYXJkU2VsZWN0b3IsXG4gIGF2YXRhckVkaXRTZWxlY3RvcixcbiAgc2V0dGluZ3MsXG4gIGZvcm1WYWxpZGF0b3JzLFxuICBwaWNQb3B1cFNlbGVjdG9yLFxuICBwcm9maWxlRWRpdEJ0bixcbiAgYWRkQ2FyZEJ0bixcbiAgZm9ybUxpc3QsXG4gIGFkZENhcmRJbnB1dFRpdGxlSWQsXG4gIGFkZENhcmRJbnB1dExpbmtJZCxcbiAgY2FyZFRlbXBTZWxlY3RvcixcbiAgYWRkQ2FyZEZvcm1JZCxcbiAgZWRpdElucHV0VGl0bGVJZCxcbiAgZWRpdElucHV0RGVzY3JpcHRpb25JZCxcbiAgYWRkQ2FyZFBvcHVwU2VsZWN0b3IsXG4gIGVkaXRQb3B1cFNlbGVjdG9yLFxuICBuYW1lU2VsZWN0b3IsXG4gIGpvYlNlbGVjdG9yLFxuICBjYXJkV3JhcHBlclNlbGVjdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbi8vIGVsZW1lbnRzXG5sZXQgY2FyZExpc3Q7XG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKGRlbGV0ZUNhcmRTZWxlY3Rvcik7XG5jb25zdCBpbWFnZUluZm8gPSBuZXcgUG9wdXBXaXRoSW1hZ2UocGljUG9wdXBTZWxlY3Rvcik7XG5jb25zdCB1c2VyUHJvZmlsZSA9IG5ldyBVc2VySW5mbyh7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pO1xuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIGFkZENhcmRQb3B1cFNlbGVjdG9yLFxuICBoYW5kbGVBZGRDYXJkU3VibWl0XG4pO1xuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdFBvcHVwU2VsZWN0b3IsIGhhbmRsZVByb2ZpbGVTdWJtaXQpO1xuY29uc3QgYXZhdGFyRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIGF2YXRhckVkaXRTZWxlY3RvcixcbiAgaGFuZGxlQXZhdGFyU3VibWl0XG4pO1xuXG4vLyBhcGlcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjYyZmJjMWRlLTQyZDYtNDFiNy04YmI1LTViMDczNjkzMmU5NlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIHByb21pc2UuYWxsXG5hcGlcbiAgLmdldENhcmRBbmRVc2VySW5mbygpXG4gIC50aGVuKChbc2VydmVyQ2FyZExpc3QsIHNlcnZlclVzZXJJbmZvXSkgPT4ge1xuICAgIC8vIGxvYWQgY2FyZHMgZnJvbSBzZXJ2ZXJcbiAgICBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogc2VydmVyQ2FyZExpc3QsXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmRJdGVtID0gY3JlYXRDYXJkKGl0ZW0pO1xuICAgICAgICAgIGNhcmRMaXN0LmFkZEluaXRpYWxJdGVtKGNhcmRJdGVtKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkV3JhcHBlclNlbGVjdG9yXG4gICAgKTtcbiAgICAvLyBhZGQgaW5pdGlhbCBjYXJkcyB0byBET01cbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhzZXJ2ZXJDYXJkTGlzdCk7XG4gICAgLy9saWtlQnRuIGFjdGl2ZSBpZiBpc0xpa2VkPXRydWVcblxuICAgIC8vIGxvYWQgdXNlciBiaW8gZnJvbSBzZXJ2ZXJcbiAgICBjb25zdCBuYW1lID0gc2VydmVyVXNlckluZm8ubmFtZTtcbiAgICBjb25zdCBqb2IgPSBzZXJ2ZXJVc2VySW5mby5hYm91dDtcbiAgICBjb25zdCBhdmF0YXIgPSBzZXJ2ZXJVc2VySW5mby5hdmF0YXI7XG4gICAgLy8gYWRkIHVzZXIgYmlvIHRvIERPTVxuICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKG5hbWUsIGpvYik7XG4gICAgdXNlclByb2ZpbGUuc2V0QXZhdGFyKGF2YXRhcik7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcbi8vIGhhbmRsZXJcblxuZnVuY3Rpb24gaGFuZGxlQXNzaWduRWRpdElucHV0KCkge1xuICBjb25zdCB1c2VyUHJvZmlsZURhdGEgPSB1c2VyUHJvZmlsZS5nZXRVc2VySW5mbygpO1xuICBlZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXModXNlclByb2ZpbGVEYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGlucHV0T2JqKSB7XG4gIGF2YXRhckVkaXRQb3B1cC5zaG93VXBsb2FkaW5nU3RhdGUoKTtcbiAgY29uc3QgYXZhdGFyTGluayA9IGlucHV0T2JqW2F2YXRhckxpbmtJbnB1dElkXTtcbiAgYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGVJbWFnZShhdmF0YXJMaW5rKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICB1c2VyUHJvZmlsZS5zZXRBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgICBhdmF0YXJFZGl0UG9wdXAuY2xvc2UoKTtcbiAgICAgIGZvcm1WYWxpZGF0b3JzW2F2YXRhckZvcm1JZF0uZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgICAgYXZhdGFyRWRpdFBvcHVwLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYXZhdGFyRWRpdFBvcHVwLnNob3dVcGxvYWRlZCgpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlU3VibWl0KGlucHV0T2JqKSB7XG4gIGNvbnN0IG5hbWVFbCA9IGlucHV0T2JqW2VkaXRJbnB1dFRpdGxlSWRdO1xuICBjb25zdCBqb2JFbCA9IGlucHV0T2JqW2VkaXRJbnB1dERlc2NyaXB0aW9uSWRdO1xuICBlZGl0UG9wdXAuc2hvd1VwbG9hZGluZ1N0YXRlKCk7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyh7XG4gICAgICBlZGl0Rm9ybU5hbWVJbnB1dDogbmFtZUVsLFxuICAgICAgZWRpdEZvcm1BYm91dElucHV0OiBqb2JFbCxcbiAgICB9KVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQpOyAvLyBnZXQgdXNlcmluZm8gZnJvbSBzZXJ2ZXIgYW5kIGFwcGx5IHRvIHByb2ZpbGVcbiAgICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xuICAgICAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUVkaXRGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICAgIGVkaXRQb3B1cC5yZXNldCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQb3B1cC5zaG93VXBsb2FkZWQoKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNyZWF0Q2FyZChpdGVtKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAgaXRlbSxcbiAgICBjYXJkVGVtcFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIGNvbnN0IGNhcmRJdGVtID0gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xuICByZXR1cm4gY2FyZEl0ZW07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoaW5wdXRPYmopIHtcbiAgY29uc3QgY2FyZE5hbWUgPSBpbnB1dE9ialthZGRDYXJkSW5wdXRUaXRsZUlkXTtcbiAgY29uc3QgY2FyZExpbmsgPSBpbnB1dE9ialthZGRDYXJkSW5wdXRMaW5rSWRdO1xuICBhZGRDYXJkUG9wdXAuc2hvd1VwbG9hZGluZ1N0YXRlKCk7XG4gIGFwaVxuICAgIC5hZGROZXdDYXJkKHsgY2FyZEVsZW1lbnROYW1lOiBjYXJkTmFtZSwgY2FyZEVsZW1lbnRMaW5rOiBjYXJkTGluayB9KVxuICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wdXAuc2hvd1VwbG9hZGVkKCk7XG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRDYXJkKGNhcmQpO1xuICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICAgIGZvcm1WYWxpZGF0b3JzW2FkZENhcmRGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgYWRkQ2FyZFBvcHVwLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFBvcHVwLnNob3dUb1VwbG9hZCgpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKHsgbmFtZSwgbGluayB9KSB7XG4gIGltYWdlSW5mby5vcGVuKHsgbmFtZSwgbGluayB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGNvbnN0IGFjdGlvblByb21pc2UgPSBjYXJkLmlzTGlrZWQoKVxuICAgID8gYXBpLnVubGlrZUNhcmQoY2FyZClcbiAgICA6IGFwaS5saWtlQ2FyZChjYXJkKTtcbiAgYWN0aW9uUHJvbWlzZVxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgY2FyZC5zZXRJc0xpa2VkKHVwZGF0ZWRDYXJkLmlzTGlrZWQpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgZGVsZXRlQ2FyZFBvcHVwLnNob3dMb2FkaW5nKCk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNob3dEZWxldGVkKCk7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbi8vIGZvcm0gdmFsaWRhdGlvblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChmb3JtTGlzdCkgPT4ge1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtKSA9PiB7XG4gICAgY29uc3QgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtKTtcbiAgICBmb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpXSA9IGZvcm1WYWxpZGF0b3I7XG4gICAgcmV0dXJuIGZvcm1WYWxpZGF0b3JzO1xuICB9KTtcbn07XG4vLyBmdW5jdGlvbiBjYWxscyBhbmQgZXZlbnQgbGlzdGVuZXJzXG5cbmFkZENhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbYWRkQ2FyZEZvcm1JZF0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGZvcm1WYWxpZGF0b3JzW2FkZENhcmRGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgYWRkQ2FyZFBvcHVwLnJlc2V0KCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVFZGl0Rm9ybUlkXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUVkaXRGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgZWRpdFBvcHVwLnJlc2V0KCk7XG4gIGVkaXRQb3B1cC5vcGVuKCk7XG4gIGhhbmRsZUFzc2lnbkVkaXRJbnB1dCgpO1xufSk7XG5hdmF0YXJFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckVkaXRQb3B1cC5yZXNldCgpO1xuICBmb3JtVmFsaWRhdG9yc1thdmF0YXJGb3JtSWRdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBmb3JtVmFsaWRhdG9yc1thdmF0YXJGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBzZXRFdmVudExpc3RlbmVyc1xuZW5hYmxlVmFsaWRhdGlvbihmb3JtTGlzdCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuaW1hZ2VJbmZvLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hdmF0YXJFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZVwiKTtcbiAgICB0aGlzLl9idG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuICBzaG93TG9hZGluZygpIHtcbiAgICB0aGlzLl9zdWJtaXRCdG4uaW5uZXJUZXh0ID0gXCJMb2FkaW5nXCI7XG4gIH1cbiAgc2hvd0RlbGV0ZWQoKSB7XG4gICAgdGhpcy5fc3VibWl0QnRuLmlubmVyVGV4dCA9IHRoaXMuX2J0blRleHQ7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAvLyB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICAvLyB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9waWNUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI29wZW4tcGljLXRpdGxlXCIpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3Blbi1waWMtaW1hZ2VcIik7XG4gIH1cbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX3BpY1RpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHRpdGxlOiB0aGlzLl9uYW1lRWwuaW5uZXJUZXh0LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYkVsLmlubmVyVGV4dCxcbiAgICB9O1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XG4gICAgdGhpcy5fbmFtZUVsLmlubmVyVGV4dCA9IG5hbWU7XG4gICAgdGhpcy5fam9iRWwuaW5uZXJUZXh0ID0gam9iO1xuICB9XG4gIHNldEF2YXRhcihsaW5rKSB7XG4gICAgdGhpcy5fYXZhdGFyRWwuc3JjID0gbGluaztcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0UmVzdWx0KHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cbiAgdXBkYXRlVXNlckluZm8oeyBlZGl0Rm9ybU5hbWVJbnB1dCwgZWRpdEZvcm1BYm91dElucHV0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZWRpdEZvcm1OYW1lSW5wdXQsXG4gICAgICAgIGFib3V0OiBlZGl0Rm9ybUFib3V0SW5wdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuZ2V0UmVzdWx0KTtcbiAgfVxuICBhZGROZXdDYXJkKHsgY2FyZEVsZW1lbnROYW1lLCBjYXJkRWxlbWVudExpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGNhcmRFbGVtZW50TmFtZSxcbiAgICAgICAgbGluazogY2FyZEVsZW1lbnRMaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cbiAgZGVsZXRlQ2FyZChfaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke19pZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5nZXRSZXN1bHQpO1xuXG4gICAgLy9yZXNwb25zZSBpcyB7XCJtZXNzYWdlXCI6IFwiVGhpcyBwb3N0IGhhcyBiZWVuIGRlbGV0ZWRcIn1cbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmQuaWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuZ2V0UmVzdWx0KTtcbiAgICAvLyAudGhlbigoY2FyZCkgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2coY2FyZCk7XG4gICAgLy8gfSk7XG4gIH1cbiAgdW5saWtlQ2FyZChjYXJkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkLmlkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gICAgLy8gLnRoZW4oKGNhcmQpID0+IHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKGNhcmQpO1xuICAgIC8vIH0pO1xuICB9XG4gIHVwZGF0ZVByb2ZpbGVJbWFnZShsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuZ2V0UmVzdWx0KTtcbiAgfVxuICBnZXRDYXJkQW5kVXNlckluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiaWQiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2RhdGEiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdG4iLCJfdHJhc2hCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJkZWxldGVDYXJkIiwicmVtb3ZlIiwic2V0SXNMaWtlZCIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsImdldFZpZXciLCJfZWxlbWVudCIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9lcnJvckxpc3QiLCJlcnJvckxpc3QiLCJfZm9ybUdldFJlc2V0IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsIl9lcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxlbWVudHNBcnJheSIsIkFycmF5IiwiZnJvbSIsIl9pbnB1dEVscyIsInNvbWUiLCJ0b2dnbGVCdXR0b25zdGF0ZSIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsIl9jbGlja092ZXJsYXkiLCJ0YXJnZXQiLCJzZXRFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ0biIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnRuIiwiX2J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRPYmoiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0SW5wdXRWYWx1ZXMiLCJpbnB1dCIsInNob3dVcGxvYWRpbmdTdGF0ZSIsImlubmVyVGV4dCIsInNob3dVcGxvYWRlZCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2xlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhZGRJbml0aWFsSXRlbSIsImFwcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImZvcm1MaXN0IiwiZm9ybVNlbGVjdG9yIiwiZWRpdElucHV0VGl0bGVJZCIsImVkaXRJbnB1dERlc2NyaXB0aW9uSWQiLCJnZXRFbGVtZW50QnlJZCIsImFkZENhcmRGb3JtSWQiLCJhdmF0YXJGb3JtSWQiLCJwcm9maWxlRWRpdEZvcm1JZCIsImNhcmRUZW1wU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ0biIsImFkZENhcmRCdG4iLCJmb3JtVmFsaWRhdG9ycyIsImF2YXRhckVkaXRCdG4iLCJjYXJkTGlzdCIsImRlbGV0ZUNhcmRQb3B1cCIsIl9idG5UZXh0Iiwic2V0U3VibWl0QWN0aW9uIiwic2hvd0xvYWRpbmciLCJzaG93RGVsZXRlZCIsImltYWdlSW5mbyIsIl9waWNUaXRsZSIsIl9pbWFnZSIsInVzZXJQcm9maWxlIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWwiLCJfam9iRWwiLCJfYXZhdGFyRWwiLCJnZXRVc2VySW5mbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJzZXRVc2VySW5mbyIsImpvYiIsInNldEF2YXRhciIsImFkZENhcmRQb3B1cCIsImlucHV0T2JqIiwiY2FyZE5hbWUiLCJjYXJkTGluayIsImFwaSIsImFkZE5ld0NhcmQiLCJjYXJkRWxlbWVudE5hbWUiLCJjYXJkRWxlbWVudExpbmsiLCJ0aGVuIiwiY2FyZCIsIm5ld0NhcmQiLCJjcmVhdENhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJzaG93VG9VcGxvYWQiLCJlZGl0UG9wdXAiLCJuYW1lRWwiLCJqb2JFbCIsInVwZGF0ZVVzZXJJbmZvIiwiZWRpdEZvcm1OYW1lSW5wdXQiLCJlZGl0Rm9ybUFib3V0SW5wdXQiLCJyZXMiLCJhYm91dCIsImF2YXRhckVkaXRQb3B1cCIsImF2YXRhckxpbmsiLCJ1cGRhdGVQcm9maWxlSW1hZ2UiLCJsb2ciLCJhdmF0YXIiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9oZWFkZXJzIiwiZ2V0UmVzdWx0Iiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiX3JlZjIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIl9yZWYzIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZ2V0Q2FyZEFuZFVzZXJJbmZvIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsInVwZGF0ZWRDYXJkIiwic2VydmVyQ2FyZExpc3QiLCJzZXJ2ZXJVc2VySW5mbyIsImNhcmRJdGVtIiwidXNlclByb2ZpbGVEYXRhIiwiaGFuZGxlQXNzaWduRWRpdElucHV0IiwiZm9ybSIsImZvcm1WYWxpZGF0b3IiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9