!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.id=e._id,this._cardSelector=t,this._data=e,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i,this.isLiked=e.isLiked}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeBtn=this._cardElement.querySelector(".card__button"),this._trashBtn=this._cardElement.querySelector(".card__trash"),this._likeBtn.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._trashBtn.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}deleteCard(){this._cardElement.remove()}setLikeAction(){this._likeBtn.classList.toggle("card__button-active"),this.isLiked=!this.isLiked}getView(){return this._element=this._getTemplate(),this._cardImageElement=this._element.querySelector(".card__image"),this._element.querySelector(".card__description").textContent=this._name,this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._setEventListeners(),this.isLiked&&this._likeBtn.classList.add("card__button-active"),this._element}}class t{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorList=e.errorList}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return this._inputElementsArray=Array.from(this._inputEls),this._inputElementsArray.some((e=>!e.validity.valid))}toggleButtonstate(){this._hasInvalidInput()?this.disableSubmitButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonstate()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this.toggleButtonstate()}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0,this._submitButton.innerText="Save"}}class s{constructor(e){this._popupSelector=e,this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_clickOverlay(e){e.target===this._popupElement&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{this._clickOverlay(e)})),this._closeBtn=this._popupElement.querySelector(".modal__close"),this._closeBtn.addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputEls=this._popupForm.querySelectorAll(".modal__input"),this._submitBtn=this._popupElement.querySelector(".modal__save")}_getInputValues(){return this._inputObj={},this._inputEls.forEach((e=>{this._inputObj[e.id]=e.value})),this._inputObj}reset(){this._popupForm.reset()}setInputValues(e){this._inputEls.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}showUploadingState(){this._submitBtn.innerText="Saving"}showUploaded(){this._submitBtn.innerText="Saved"}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._renderedItems=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}addInitialItem(e){this._container.append(e)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}}const n=document.querySelectorAll(".modal__form"),o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",errorList:".modal__error"},a="modal-title-input",l=(document.getElementById(a),"modal-description-input"),d=(document.getElementById(l),"#card-template"),c=document.querySelector("#profile-edit-button"),h=document.querySelector(".profile__add-button"),u={},_=(document.querySelector("#delete-card-modal"),document.querySelectorAll(".card__trash"),document.querySelector("#profile-avatar-edit-button")),m=(document.querySelector("#change-profile-pic-modal"),document.querySelector("#delete-card-modal"),document.querySelector("#delete-card-submit-btn"),document.querySelector(".profile__photo"));let p;document.querySelectorAll(".modal__save");const E=new class extends s{constructor(e){super(e),this._submitBtn=this._popupElement.querySelector(".modal__save")}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._submitBtn.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#delete-card-modal"),b=new class extends s{constructor(e){super(e),this._picTitle=this._popupElement.querySelector("#open-pic-title"),this._image=this._popupElement.querySelector("#open-pic-image")}open(e){let{name:t,link:s}=e;this._picTitle.textContent=t,this._image.src=s,this._image.alt=t,super.open()}}("#open-pic-modal"),v=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameEl=document.querySelector(t),this._jobEl=document.querySelector(s),this._avatarEl=document.querySelector(r)}getUserInfo(){return{title:this._nameEl.innerText,description:this._jobEl.innerText}}setUserInfo(e,t){this._nameEl.innerText=e,this._jobEl.innerText=t}setAvatar(e){this._avatarEl.src=e}}({nameSelector:"#js-profile-name",jobSelector:"#js-profile-description",avatarSelector:"#js-avatar"}),S=new r("#profile-add-card-modal",(function(e){S.close();const t=e["modal-image-title-input"],s=e["modal-link-input"];S.showUploadingState(),y.addNewCard({cardElementName:t,cardElementLink:s}).then((e=>{S.showUploaded();const t=L(e);p.addItem(t),u["add-card-form"].disableSubmitButton(),S.reset()})).catch((e=>{console.error(e)}))})),f=new r("#profile-edit-modal",(function(e){const t=e[a],s=e[l];f.showUploadingState(),y.updateUserInfo({editFormNameInput:t,editFormAboutInput:s}).then(f.showUploaded()).catch((e=>{console.error(e)})),v.setUserInfo(t,s),f.close(),u["profile-edit-form"].disableSubmitButton(),f.reset()})),g=new r("#change-profile-pic-modal",(function(e){g.showUploadingState();const t=e["modal-avatar-input"];y.updateProfileImage(t).then(g.showUploaded()).catch((e=>{console.error(e)})),m.src=t,g.close(),u["change-profile-pic-form"].disableSubmitButton(),g.reset()})),y=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this._headers=s}getResult(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this._headers}).then(this.getResult)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this._headers}).then(this.getResult)}updateUserInfo(e){let{editFormNameInput:t,editFormAboutInput:s}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this.getResult)}addNewCard(e){let{cardElementName:t,cardElementLink:s}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this.getResult)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this.getResult)}likeCard(e){return fetch(`${this.baseUrl}/cards/${e.id}/likes`,{method:"PUT",headers:this._headers}).then(this.getResult).then((e=>{console.log(e)}))}unlikeCard(e){return fetch(`${this.baseUrl}/cards/${e.id}/likes`,{method:"DELETE",headers:this._headers}).then(this.getResult).then((e=>{console.log(e)}))}updateProfileImage(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this.getResult)}getCardAndUserInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"62fbc1de-42d6-41b7-8bb5-5b0736932e96","Content-Type":"application/json"}});function L(t){return new e(t,d,k,C,I).getView()}function k(e){let{name:t,link:s}=e;b.open({name:t,link:s})}function I(e){(e.isLiked?y.unlikeCard(e).catch((e=>{console.error(e)})):y.likeCard(e).catch((e=>{console.error(e)}))).then((t=>{e.setLikeAction()})).catch((e=>{console.error(e)}))}function C(e){E.open(),E.setSubmitAction((()=>{e.deleteCard(),y.deleteCard(e.id).then(E.close()).catch((e=>{console.error(e)}))}))}y.getCardAndUserInfo().then((e=>{let[t,s]=e;p=new i({items:t,renderer:e=>{const t=L(e);p.addInitialItem(t)}},".cards__list"),p.renderItems(t);const r=s.name,n=s.about,o=s.avatar;v.setUserInfo(r,n),v.setAvatar(o)})).catch((e=>{console.error(e)})),h.addEventListener("click",(()=>{S.open()})),c.addEventListener("click",(()=>{f.open(),function(){const e=v.getUserInfo();f.setInputValues(e)}()})),_.addEventListener("click",(()=>{g.open()})),(e=>{e.forEach((e=>{const s=new t(o,e);return s.enableValidation(),u[e.getAttribute("id")]=s,u}))})(n),S.setEventListeners(),f.setEventListeners(),b.setEventListeners(),g.setEventListeners(),E.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxFQUFlTixPQUU5QjVELEVBQVlVLFlBQVloSixFQUFNaUosR0FDOUJYLEVBQVlZLFVBQVVnRCxFQUFPLElBRTlCbkMsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQXlIdEJwQyxFQUFXeEcsaUJBQWlCLFNBQVMsS0FDbkMrSCxFQUFhbkUsTUFBTSxJQUVyQjJDLEVBQWV2RyxpQkFBaUIsU0FBUyxLQUN2QytJLEVBQVVuRixPQXpIWixXQUNFLE1BQU0wSCxFQUFrQnBFLEVBQVlPLGNBQ3BDc0IsRUFBVWpFLGVBQWV3RyxFQUMzQixDQXVIRUMsRUFBdUIsSUFFekI3RSxFQUFjMUcsaUJBQWlCLFNBQVMsS0FDdENxSixFQUFnQnpGLE1BQU0sSUFwQkVxQyxLQUN4QkEsRUFBU2pELFNBQVN3SSxJQUNoQixNQUFNQyxFQUFnQixJQUFJNUssRUFBY0MsRUFBVTBLLEdBSWxELE9BSEFDLEVBQWN2SSxtQkFDZHVELEVBQWUrRSxFQUFLRSxhQUFhLE9BQVNELEVBRW5DaEYsQ0FBYyxHQUNyQixFQWlCSnZELENBQWlCK0MsR0FDakI4QixFQUFhN0Qsb0JBQ2I2RSxFQUFVN0Usb0JBQ1Y2QyxFQUFVN0Msb0JBQ1ZtRixFQUFnQm5GLG9CQUNoQjJDLEVBQWdCM0MsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLmlkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuaXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcbiAgfVxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvblwiKTtcbiAgICB0aGlzLl90cmFzaEJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XG4gICAgdGhpcy5fbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RyYXNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2RhdGEpO1xuICAgIH0pO1xuICB9XG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cbiAgc2V0TGlrZUFjdGlvbigpIHtcbiAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19idXR0b24tYWN0aXZlXCIpO1xuICAgIHRoaXMuaXNMaWtlZCA9ICF0aGlzLmlzTGlrZWQ7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JMaXN0ID0gc2V0dGluZ3MuZXJyb3JMaXN0O1xuICB9XG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHNBcnJheSA9IEFycmF5LmZyb20odGhpcy5faW5wdXRFbHMpO1xuICAgIHJldHVybiB0aGlzLl9pbnB1dEVsZW1lbnRzQXJyYXkuc29tZSgoaW5wdXRFbCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG4gIHRvZ2dsZUJ1dHRvbnN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0pO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uc3RhdGUoKTtcbiAgfVxuICBkaXNhYmxlU3VibWl0QnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmlubmVyVGV4dCA9IFwiU2F2ZVwiO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgX2NsaWNrT3ZlcmxheShlKSB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5fY2xpY2tPdmVybGF5KGUpO1xuICAgIH0pO1xuICAgIHRoaXMuX2Nsb3NlQnRuID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2Nsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0RWxzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xuICB9XG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9pbnB1dE9iaiA9IHt9O1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2lucHV0T2JqW2lucHV0RWwuaWRdID0gaW5wdXRFbC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRPYmo7XG4gIH1cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbiAgc2hvd1VwbG9hZGluZ1N0YXRlKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ0bi5pbm5lclRleHQgPSBcIlNhdmluZ1wiO1xuICB9XG4gIHNob3dVcGxvYWRlZCgpIHtcbiAgICB0aGlzLl9zdWJtaXRCdG4uaW5uZXJUZXh0ID0gXCJTYXZlZFwiO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2xlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2xlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuICBhZGRJbml0aWFsSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG59XG4iLCIvKipUaGUgaW5kZXguanMgZmlsZSBtdXN0IGNvbnRhaW4gb25seSB0aGUgY29kZSBmb3Igc2VsZWN0aW5nIGVsZW1lbnRzLCBjcmVhdGluZyBjbGFzcyBpbnN0YW5jZXMsIGFuZCBhZGRpbmcgc3BlY2lmaWMgZXZlbnQgbGlzdGVuZXJzLiBPdGhlciBjb2RlLCBzdWNoIGFzIHRoZSBhcnJheSBvZiBpbml0aWFsIGNhcmRzIGFuZCBhbnkgY29uZmlndXJhdGlvbiBvYmplY3RzIHlvdSBhcmUgdXNpbmcsIHNob3VsZCBiZSBtb3ZlZCB0byBhIHNlcGFyYXRlIHV0aWxzL2NvbnN0YW50cy5qcyBmaWxlIGFuZCBpbXBvcnRlZCBpbnRvIGluZGV4LmpzICovXG5cbmV4cG9ydCBjb25zdCBjYXJkV3JhcHBlclNlbGVjdG9yID0gXCIuY2FyZHNfX2xpc3RcIjtcbmV4cG9ydCBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG4gIGVycm9yTGlzdDogXCIubW9kYWxfX2Vycm9yXCIsXG59O1xuZXhwb3J0IGNvbnN0IG5hbWVTZWxlY3RvciA9IFwiI2pzLXByb2ZpbGUtbmFtZVwiO1xuZXhwb3J0IGNvbnN0IGpvYlNlbGVjdG9yID0gXCIjanMtcHJvZmlsZS1kZXNjcmlwdGlvblwiO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cFNlbGVjdG9yID0gXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiO1xuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cFNlbGVjdG9yID0gXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCI7XG5leHBvcnQgY29uc3QgZWRpdElucHV0VGl0bGVJZCA9IFwibW9kYWwtdGl0bGUtaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBlZGl0SW5wdXRUaXRsZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWRpdElucHV0VGl0bGVJZCk7XG5leHBvcnQgY29uc3QgZWRpdElucHV0RGVzY3JpcHRpb25JZCA9IFwibW9kYWwtZGVzY3JpcHRpb24taW5wdXRcIjtcbmV4cG9ydCBjb25zdCBlZGl0SW5wdXREZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gIGVkaXRJbnB1dERlc2NyaXB0aW9uSWRcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZElucHV0VGl0bGVJZCA9IFwibW9kYWwtaW1hZ2UtdGl0bGUtaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBhZGRDYXJkSW5wdXRMaW5rSWQgPSBcIm1vZGFsLWxpbmstaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybUlkID0gXCJhZGQtY2FyZC1mb3JtXCI7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybUlkID0gXCJjaGFuZ2UtcHJvZmlsZS1waWMtZm9ybVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybUlkID0gXCJwcm9maWxlLWVkaXQtZm9ybVwiO1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwaWNQb3B1cFNlbGVjdG9yID0gXCIjb3Blbi1waWMtbW9kYWxcIjtcbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgdHJhc2hCdG5BcnIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRfX3RyYXNoXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWF2YXRhci1lZGl0LWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2NoYW5nZS1wcm9maWxlLXBpYy1tb2RhbFwiXG4pO1xuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRTZWxlY3RvciA9IFwiI2NoYW5nZS1wcm9maWxlLXBpYy1tb2RhbFwiO1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRTZWxlY3RvciA9IFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCI7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjZGVsZXRlLWNhcmQtc3VibWl0LWJ0blwiXG4pO1xuZXhwb3J0IGNvbnN0IGF2YXRhckxpbmtJbnB1dElkID0gXCJtb2RhbC1hdmF0YXItaW5wdXRcIjtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3Bob3RvXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhclNlbGVjdG9yID0gXCIjanMtYXZhdGFyXCI7XG5leHBvcnQgY29uc3Qgc2F2ZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19zYXZlXCIpO1xuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7XG4gIGF2YXRhckVkaXRCdG4sXG4gIHNhdmVCdG5zLFxuICBhdmF0YXJGb3JtSWQsXG4gIGF2YXRhclNlbGVjdG9yLFxuICBhdmF0YXJJbWcsXG4gIGF2YXRhckxpbmtJbnB1dElkLFxuICBwcm9maWxlRWRpdEZvcm1JZCxcbiAgZGVsZXRlQ2FyZEVsLFxuICBkZWxldGVDYXJkU3VibWl0QnRuLFxuICBkZWxldGVDYXJkU2VsZWN0b3IsXG4gIGF2YXRhckVkaXRTZWxlY3RvcixcbiAgc2V0dGluZ3MsXG4gIGZvcm1WYWxpZGF0b3JzLFxuICBwaWNQb3B1cFNlbGVjdG9yLFxuICBwcm9maWxlRWRpdEJ0bixcbiAgYWRkQ2FyZEJ0bixcbiAgZm9ybUxpc3QsXG4gIGFkZENhcmRJbnB1dFRpdGxlSWQsXG4gIGFkZENhcmRJbnB1dExpbmtJZCxcbiAgY2FyZFRlbXBTZWxlY3RvcixcbiAgYWRkQ2FyZEZvcm1JZCxcbiAgZWRpdElucHV0VGl0bGVJZCxcbiAgZWRpdElucHV0RGVzY3JpcHRpb25JZCxcbiAgYWRkQ2FyZFBvcHVwU2VsZWN0b3IsXG4gIGVkaXRQb3B1cFNlbGVjdG9yLFxuICBuYW1lU2VsZWN0b3IsXG4gIGpvYlNlbGVjdG9yLFxuICBjYXJkV3JhcHBlclNlbGVjdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbi8vIGVsZW1lbnRzXG5sZXQgY2FyZExpc3Q7XG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKGRlbGV0ZUNhcmRTZWxlY3Rvcik7XG5jb25zdCBpbWFnZUluZm8gPSBuZXcgUG9wdXBXaXRoSW1hZ2UocGljUG9wdXBTZWxlY3Rvcik7XG5jb25zdCB1c2VyUHJvZmlsZSA9IG5ldyBVc2VySW5mbyh7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pO1xuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIGFkZENhcmRQb3B1cFNlbGVjdG9yLFxuICBoYW5kbGVBZGRDYXJkU3VibWl0XG4pO1xuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdFBvcHVwU2VsZWN0b3IsIGhhbmRsZVByb2ZpbGVTdWJtaXQpO1xuY29uc3QgYXZhdGFyRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIGF2YXRhckVkaXRTZWxlY3RvcixcbiAgaGFuZGxlQXZhdGFyU3VibWl0XG4pO1xuXG4vLyBhcGlcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjYyZmJjMWRlLTQyZDYtNDFiNy04YmI1LTViMDczNjkzMmU5NlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIHByb21pc2UuYWxsXG5hcGlcbiAgLmdldENhcmRBbmRVc2VySW5mbygpXG4gIC50aGVuKChbc2VydmVyQ2FyZExpc3QsIHNlcnZlclVzZXJJbmZvXSkgPT4ge1xuICAgIC8vIGxvYWQgY2FyZHMgZnJvbSBzZXJ2ZXJcbiAgICBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogc2VydmVyQ2FyZExpc3QsXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmRJdGVtID0gY3JlYXRDYXJkKGl0ZW0pO1xuICAgICAgICAgIGNhcmRMaXN0LmFkZEluaXRpYWxJdGVtKGNhcmRJdGVtKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkV3JhcHBlclNlbGVjdG9yXG4gICAgKTtcbiAgICAvLyBhZGQgaW5pdGlhbCBjYXJkcyB0byBET01cbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhzZXJ2ZXJDYXJkTGlzdCk7XG4gICAgLy9saWtlQnRuIGFjdGl2ZSBpZiBpc0xpa2VkPXRydWVcblxuICAgIC8vIGxvYWQgdXNlciBiaW8gZnJvbSBzZXJ2ZXJcbiAgICBjb25zdCBuYW1lID0gc2VydmVyVXNlckluZm8ubmFtZTtcbiAgICBjb25zdCBqb2IgPSBzZXJ2ZXJVc2VySW5mby5hYm91dDtcbiAgICBjb25zdCBhdmF0YXIgPSBzZXJ2ZXJVc2VySW5mby5hdmF0YXI7XG4gICAgLy8gYWRkIHVzZXIgYmlvIHRvIERPTVxuICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKG5hbWUsIGpvYik7XG4gICAgdXNlclByb2ZpbGUuc2V0QXZhdGFyKGF2YXRhcik7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcbi8vIGhhbmRsZXJcblxuZnVuY3Rpb24gaGFuZGxlQXNzaWduRWRpdElucHV0KCkge1xuICBjb25zdCB1c2VyUHJvZmlsZURhdGEgPSB1c2VyUHJvZmlsZS5nZXRVc2VySW5mbygpO1xuICBlZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXModXNlclByb2ZpbGVEYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGlucHV0T2JqKSB7XG4gIGF2YXRhckVkaXRQb3B1cC5zaG93VXBsb2FkaW5nU3RhdGUoKTtcbiAgY29uc3QgYXZhdGFyTGluayA9IGlucHV0T2JqW2F2YXRhckxpbmtJbnB1dElkXTtcbiAgYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGVJbWFnZShhdmF0YXJMaW5rKVxuICAgIC50aGVuKGF2YXRhckVkaXRQb3B1cC5zaG93VXBsb2FkZWQoKSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pO1xuICBhdmF0YXJJbWcuc3JjID0gYXZhdGFyTGluaztcbiAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKCk7XG4gIGZvcm1WYWxpZGF0b3JzW2F2YXRhckZvcm1JZF0uZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICBhdmF0YXJFZGl0UG9wdXAucmVzZXQoKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZVN1Ym1pdChpbnB1dE9iaikge1xuICBjb25zdCBuYW1lRWwgPSBpbnB1dE9ialtlZGl0SW5wdXRUaXRsZUlkXTtcbiAgY29uc3Qgam9iRWwgPSBpbnB1dE9ialtlZGl0SW5wdXREZXNjcmlwdGlvbklkXTtcbiAgZWRpdFBvcHVwLnNob3dVcGxvYWRpbmdTdGF0ZSgpO1xuICBhcGlcbiAgICAudXBkYXRlVXNlckluZm8oe1xuICAgICAgZWRpdEZvcm1OYW1lSW5wdXQ6IG5hbWVFbCxcbiAgICAgIGVkaXRGb3JtQWJvdXRJbnB1dDogam9iRWwsXG4gICAgfSlcbiAgICAudGhlbihlZGl0UG9wdXAuc2hvd1VwbG9hZGVkKCkpXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbiAgLy8gc2VudCBpbnB1dHMgdG8gc2VydmVyXG4gIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKG5hbWVFbCwgam9iRWwpO1xuICAvLyBnZXQgdXNlcmluZm8gZnJvbSBzZXJ2ZXIgYW5kIGFwcGx5IHRvIHByb2ZpbGVcbiAgZWRpdFBvcHVwLmNsb3NlKCk7XG4gIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVFZGl0Rm9ybUlkXS5kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG4gIGVkaXRQb3B1cC5yZXNldCgpO1xufVxuZnVuY3Rpb24gY3JlYXRDYXJkKGl0ZW0pIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICBpdGVtLFxuICAgIGNhcmRUZW1wU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgY29uc3QgY2FyZEl0ZW0gPSBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG4gIHJldHVybiBjYXJkSXRlbTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChpbnB1dE9iaikge1xuICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcbiAgY29uc3QgY2FyZE5hbWUgPSBpbnB1dE9ialthZGRDYXJkSW5wdXRUaXRsZUlkXTtcbiAgY29uc3QgY2FyZExpbmsgPSBpbnB1dE9ialthZGRDYXJkSW5wdXRMaW5rSWRdO1xuICBhZGRDYXJkUG9wdXAuc2hvd1VwbG9hZGluZ1N0YXRlKCk7XG4gIGFwaVxuICAgIC5hZGROZXdDYXJkKHsgY2FyZEVsZW1lbnROYW1lOiBjYXJkTmFtZSwgY2FyZEVsZW1lbnRMaW5rOiBjYXJkTGluayB9KVxuICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wdXAuc2hvd1VwbG9hZGVkKCk7XG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRDYXJkKGNhcmQpO1xuICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICAgIGZvcm1WYWxpZGF0b3JzW2FkZENhcmRGb3JtSWRdLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcbiAgICAgIGFkZENhcmRQb3B1cC5yZXNldCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayh7IG5hbWUsIGxpbmsgfSkge1xuICBpbWFnZUluZm8ub3Blbih7IG5hbWUsIGxpbmsgfSk7XG59XG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xuICBjb25zdCBhY3Rpb25Qcm9taXNlID0gY2FyZC5pc0xpa2VkXG4gICAgPyBhcGkudW5saWtlQ2FyZChjYXJkKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgOiBhcGkubGlrZUNhcmQoY2FyZCkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgYWN0aW9uUHJvbWlzZVxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgY2FyZC5zZXRMaWtlQWN0aW9uKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbihkZWxldGVDYXJkUG9wdXAuY2xvc2UoKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9KTtcbiAgLy8oKT0+e30gZG9lc250IHJ1biB0aWxsIGZvcm0gaXMgc3VibWl0ZWRcbn1cblxuLy8gZm9ybSB2YWxpZGF0aW9uXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGZvcm1MaXN0KSA9PiB7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm0pID0+IHtcbiAgICBjb25zdCBmb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm0pO1xuICAgIGZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIildID0gZm9ybVZhbGlkYXRvcjtcblxuICAgIHJldHVybiBmb3JtVmFsaWRhdG9ycztcbiAgfSk7XG59O1xuXG4vLyBmdW5jdGlvbiBjYWxscyBhbmQgZXZlbnQgbGlzdGVuZXJzXG5cbmFkZENhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdFBvcHVwLm9wZW4oKTtcbiAgaGFuZGxlQXNzaWduRWRpdElucHV0KCk7XG59KTtcbmF2YXRhckVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBzZXRFdmVudExpc3RlbmVyc1xuZW5hYmxlVmFsaWRhdGlvbihmb3JtTGlzdCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuaW1hZ2VJbmZvLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hdmF0YXJFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZVwiKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAvLyB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICAvLyB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9waWNUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI29wZW4tcGljLXRpdGxlXCIpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3Blbi1waWMtaW1hZ2VcIik7XG4gIH1cbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX3BpY1RpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHRpdGxlOiB0aGlzLl9uYW1lRWwuaW5uZXJUZXh0LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYkVsLmlubmVyVGV4dCxcbiAgICB9O1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XG4gICAgdGhpcy5fbmFtZUVsLmlubmVyVGV4dCA9IG5hbWU7XG4gICAgdGhpcy5fam9iRWwuaW5uZXJUZXh0ID0gam9iO1xuICB9XG4gIHNldEF2YXRhcihsaW5rKSB7XG4gICAgdGhpcy5fYXZhdGFyRWwuc3JjID0gbGluaztcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0UmVzdWx0KHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cbiAgdXBkYXRlVXNlckluZm8oeyBlZGl0Rm9ybU5hbWVJbnB1dCwgZWRpdEZvcm1BYm91dElucHV0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZWRpdEZvcm1OYW1lSW5wdXQsXG4gICAgICAgIGFib3V0OiBlZGl0Rm9ybUFib3V0SW5wdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuZ2V0UmVzdWx0KTtcbiAgfVxuICBhZGROZXdDYXJkKHsgY2FyZEVsZW1lbnROYW1lLCBjYXJkRWxlbWVudExpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGNhcmRFbGVtZW50TmFtZSxcbiAgICAgICAgbGluazogY2FyZEVsZW1lbnRMaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLmdldFJlc3VsdCk7XG4gIH1cbiAgZGVsZXRlQ2FyZChfaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke19pZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5nZXRSZXN1bHQpO1xuXG4gICAgLy9yZXNwb25zZSBpcyB7XCJtZXNzYWdlXCI6IFwiVGhpcyBwb3N0IGhhcyBiZWVuIGRlbGV0ZWRcIn1cbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmQuaWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5nZXRSZXN1bHQpXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhjYXJkKTtcbiAgICAgIH0pO1xuICB9XG4gIHVubGlrZUNhcmQoY2FyZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZC5pZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLmdldFJlc3VsdClcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGNhcmQpO1xuICAgICAgfSk7XG4gIH1cbiAgdXBkYXRlUHJvZmlsZUltYWdlKGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5nZXRSZXN1bHQpO1xuICB9XG4gIGdldENhcmRBbmRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJpZCIsIl9pZCIsIl9jYXJkU2VsZWN0b3IiLCJfZGF0YSIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsImlzTGlrZWQiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdG4iLCJfdHJhc2hCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJkZWxldGVDYXJkIiwicmVtb3ZlIiwic2V0TGlrZUFjdGlvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImdldFZpZXciLCJfZWxlbWVudCIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiYWRkIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9lcnJvckxpc3QiLCJlcnJvckxpc3QiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiX2Vycm9yTWVzc2FnZUVsIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbGVtZW50c0FycmF5IiwiQXJyYXkiLCJmcm9tIiwiX2lucHV0RWxzIiwic29tZSIsInRvZ2dsZUJ1dHRvbnN0YXRlIiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsImlubmVyVGV4dCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiX2NsaWNrT3ZlcmxheSIsInRhcmdldCIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2Nsb3NlQnRuIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdG4iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRPYmoiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0SW5wdXRWYWx1ZXMiLCJpbnB1dCIsInNob3dVcGxvYWRpbmdTdGF0ZSIsInNob3dVcGxvYWRlZCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2xlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhZGRJbml0aWFsSXRlbSIsImFwcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImZvcm1MaXN0IiwiZm9ybVNlbGVjdG9yIiwiZWRpdElucHV0VGl0bGVJZCIsImVkaXRJbnB1dERlc2NyaXB0aW9uSWQiLCJnZXRFbGVtZW50QnlJZCIsImNhcmRUZW1wU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ0biIsImFkZENhcmRCdG4iLCJmb3JtVmFsaWRhdG9ycyIsImF2YXRhckVkaXRCdG4iLCJhdmF0YXJJbWciLCJjYXJkTGlzdCIsImRlbGV0ZUNhcmRQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImltYWdlSW5mbyIsIl9waWNUaXRsZSIsIl9pbWFnZSIsInVzZXJQcm9maWxlIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWwiLCJfam9iRWwiLCJfYXZhdGFyRWwiLCJnZXRVc2VySW5mbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJzZXRVc2VySW5mbyIsImpvYiIsInNldEF2YXRhciIsImFkZENhcmRQb3B1cCIsImlucHV0T2JqIiwiY2FyZE5hbWUiLCJjYXJkTGluayIsImFwaSIsImFkZE5ld0NhcmQiLCJjYXJkRWxlbWVudE5hbWUiLCJjYXJkRWxlbWVudExpbmsiLCJ0aGVuIiwiY2FyZCIsIm5ld0NhcmQiLCJjcmVhdENhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImVkaXRQb3B1cCIsIm5hbWVFbCIsImpvYkVsIiwidXBkYXRlVXNlckluZm8iLCJlZGl0Rm9ybU5hbWVJbnB1dCIsImVkaXRGb3JtQWJvdXRJbnB1dCIsImF2YXRhckVkaXRQb3B1cCIsImF2YXRhckxpbmsiLCJ1cGRhdGVQcm9maWxlSW1hZ2UiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9oZWFkZXJzIiwiZ2V0UmVzdWx0IiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiX3JlZjIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiX3JlZjMiLCJsaWtlQ2FyZCIsImxvZyIsInVubGlrZUNhcmQiLCJhdmF0YXIiLCJnZXRDYXJkQW5kVXNlckluZm8iLCJhbGwiLCJhdXRob3JpemF0aW9uIiwidXBkYXRlZENhcmQiLCJzZXJ2ZXJDYXJkTGlzdCIsInNlcnZlclVzZXJJbmZvIiwiY2FyZEl0ZW0iLCJ1c2VyUHJvZmlsZURhdGEiLCJoYW5kbGVBc3NpZ25FZGl0SW5wdXQiLCJmb3JtIiwiZm9ybVZhbGlkYXRvciIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=